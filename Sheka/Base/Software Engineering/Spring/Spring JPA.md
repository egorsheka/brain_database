03.04.2022  17:01
Tags:  |
____

# Spring JPA
## @Transactional 


### isolation

про изоляцию в бд вики https://ru.wikipedia.org/wiki/%D0%A3%D1%80%D0%BE%D0%B2%D0%B5%D0%BD%D1%8C_%D0%B8%D0%B7%D0%BE%D0%BB%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D1%82%D1%80%D0%B0%D0%BD%D0%B7%D0%B0%D0%BA%D1%86%D0%B8%D0%B9


**DEFAULT**: Использовать уровень изоляции установленный по умолчанию в базовой базе данных.  

**READ_UNCOMMITTED** (чтение незафиксированных данных): Этот уровень изоляции указывает, что транзакция может считывать данные, которые еще не удалены другими транзакциями.  
 
**READ_COMMITTED** (чтение фиксированных данных): Постоянная, указывающая, что “грязное” чтение предотвращено; могут возникать неповторяющееся чтение и фантомное чтение.  
  
**REPEATABLE_READ** (повторяемость чтения): Постоянная, указывающая на то, что “грязное” чтение и неповторяемое чтение предотвращаются; может появляться фантомное чтение.  
  
**SERIALIZABLE** (упорядочиваемость): Постоянная, указывающая, что “грязное” чтение, неповторяемое чтение и фантомное чтение предотвращены.

### propagation
топ статья на русском https://sysout.ru/transaction-propagation/
топ краткая выжатая полная статья на англ https://www.javainuse.com/spring/boot-transaction-propagation

_1. MANDATORY_ — использует существующую транзакцию. Если ее нет — бросает exception. Если используется для класса, то действует на все public методы.  
_2. NESTED_ — вложенная транзакция (подтранзакция). Подтвержается вместе с внешней транзакцией. Если нет существующей транзакции — работает как REQUIRED.  
Можно применять в таких случаях, когда: Сработает — норм, не сработает — тоже норм. Самое главное чтобы внешняя транзакция не пострадала.  
_3. NEVER_ — означает, что данный метод не должен выполняться в транзакции. Если транзакция запущена — бросает exception.  
_4. NOT_SUPPORTED_ — означает не выполнять в текущей транзакции. Если транзакция запущена — она останавливается на время выполнения метода. Метод выполняется вне транзакции. Когда метод выполнился — транзакция запускается.  
_5. REQUIRED_ — (по умолчанию) означает, что если запущена транзакция — выполнять внутри нее, иначе создает новую транзакцию. Если ошибка в запросе, то в базу ничего на запишется.  
_6. REQUIRES_NEW_ — создает в любом случае новую транзакцию. Если запущена существующая транзакция — она останавливается на время выполнения метода, новый метод выполняется в новой транзакции, и дальше выполняется внешняя транзакция, если она есть.  
_7. SUPPORTS_ — может выполняться внутри транзакции, если она запущена, иначе выполнять без транзакции (новую транзакцию не создает), т.е. методу не важно, будет транзакция или нет, он в любом случае выполнится, но если будет транзакция, то он выполнится внутри нее.


____ 
### Links
- https://habr.com/ru/company/otus/blog/431508/
- https://medium.com/@kirill.sereda/%D1%82%D1%80%D0%B0%D0%BD%D0%B7%D0%B0%D0%BA%D1%86%D0%B8%D0%B8-%D0%B2-spring-framework-a7ec509df6d2